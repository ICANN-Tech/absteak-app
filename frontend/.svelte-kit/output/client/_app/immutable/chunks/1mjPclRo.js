import{w as g,d as m}from"./CBjSQ69Q.js";function N(e={}){const{hideDelay:t=2e3,showDelay:i=2e3,proximityRadius:n=100,componentPosition:o={x:0,y:0},initialVisible:s=!1,timeBasedMode:u=!1,areaBasedMode:a=!1,triggerMode:V=!1,autoStart:x=!1,showComponent:p=!1}=e,r=g(s),z=g(p),D=g(u),E=g(a),H=g(V);let y=null,v=null,A=null,S=null,R={...o},$=n,M=!1;function O(){d(),r.set(!0)}function W(){d(),r.set(!1)}function j(){r.update(c=>!c)}function J(c){z.set(c)}function d(){y&&(clearTimeout(y),y=null),v&&(clearTimeout(v),v=null)}function q(){L(),D.set(!0),A=setInterval(()=>{r.update(c=>(c?y=setTimeout(()=>{r.set(!1)},t):v=setTimeout(()=>{r.set(!0)},i),!c))},Math.max(t,i)),s?(r.set(!0),y=setTimeout(()=>{r.set(!1)},t)):(r.set(!1),v=setTimeout(()=>{r.set(!0)},i))}function L(){D.set(!1),d(),A&&(clearInterval(A),A=null)}function K(c,k,T,I){return Math.sqrt(Math.pow(T-c,2)+Math.pow(I-k,2))}function Q(c){const k=K(c.clientX,c.clientY,R.x,R.y),T=M;M=k<=$,M&&!T?(d(),r.set(!0)):!M&&T&&(d(),y=setTimeout(()=>{r.set(!1)},t))}function F(){B(),E.set(!0),typeof window<"u"&&(S=Q,window.addEventListener("mousemove",S))}function B(){E.set(!1),d(),S&&typeof window<"u"&&(window.removeEventListener("mousemove",S),S=null),M=!1}function U(c,k){R={x:c,y:k}}function Z(c){$=c}function _(){L(),B(),d()}return x&&(u&&q(),a&&F()),V&&H.set(!0),{visible:r,showComponent:z,isTimeMode:D,isAreaMode:E,isTriggerMode:H,show:O,hide:W,toggle:j,setShowComponent:J,startTimeCycle:q,stopTimeCycle:L,enableAreaMode:F,disableAreaMode:B,updateComponentPosition:U,setProximityRadius:Z,destroy:_}}const ee={quickCycle:{hideDelay:1e3,showDelay:1e3},standardCycle:{hideDelay:2e3,showDelay:2e3},slowCycle:{hideDelay:4e3,showDelay:4e3},closeProximity:{proximityRadius:50},mediumProximity:{proximityRadius:100},wideProximity:{proximityRadius:200},instant:{hideDelay:0,showDelay:0}};function te(e){const t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}const l=g({activeComponents:new Map,globalVisible:!0,mousePosition:{x:0,y:0},isMouseTracking:!1}),f=new Map;function C(e,t){if(Array.isArray(e))return e.map(o=>{const s=h.getComponent(o);return s?w(o)?(console.warn(`Component with ID "${o}" is locked. Cannot change visibility.`),!1):(s.setShowComponent(t),!0):(console.warn(`Component with ID "${o}" not found. Cannot set visibility.`),!1)}).every(o=>o);const i=h.getComponent(e);return i?w(e)?(console.warn(`Component with ID "${e}" is locked. Cannot change visibility.`),!1):(i.setShowComponent(t),!0):(console.warn(`Component with ID "${e}" not found. Cannot set visibility.`),!1)}function oe(e){return Array.isArray(e)?e.map(i=>C(i,!0)).every(i=>i):C(e,!0)}function ne(e){return Array.isArray(e)?e.map(i=>C(i,!1)).every(i=>i):C(e,!1)}function se(e){return Array.isArray(e)?e.map(i=>C(i,null)).every(i=>i):C(e,null)}function w(e){return f.get(e)?.locked??!1}function X(e){return f.get(e)?.lockedValue??null}let b=null;function Y(){typeof window>"u"||b||(b=e=>{l.update(t=>({...t,mousePosition:{x:e.clientX,y:e.clientY}}))},window.addEventListener("mousemove",b),l.update(e=>({...e,isMouseTracking:!0})))}function P(){b&&typeof window<"u"&&(window.removeEventListener("mousemove",b),b=null),l.update(e=>({...e,isMouseTracking:!1}))}class G{componentId;positionState;config;constructor(t,i={}){this.componentId=t,this.config=i,this.positionState=N(i),l.update(n=>(n.activeComponents.set(t,this.positionState),n))}get visible(){return this.positionState.visible}get showComponent(){return this.positionState.showComponent}get modes(){return{isTimeMode:this.positionState.isTimeMode,isAreaMode:this.positionState.isAreaMode,isTriggerMode:this.positionState.isTriggerMode}}show=()=>this.positionState.show();hide=()=>this.positionState.hide();toggle=()=>this.positionState.toggle();setShowComponent=t=>{if(w(this.componentId)){const i=X(this.componentId);this.positionState.setShowComponent(i);return}this.positionState.setShowComponent(t)};startTimeCycle=()=>this.positionState.startTimeCycle();stopTimeCycle=()=>this.positionState.stopTimeCycle();enableAreaMode=()=>{Y(),this.positionState.enableAreaMode()};disableAreaMode=()=>this.positionState.disableAreaMode();updatePosition=(t,i)=>{this.positionState.updateComponentPosition(t,i)};updatePositionFromElement=t=>{const i=te(t);this.updatePosition(i.x,i.y)};setProximityRadius=t=>{this.positionState.setProximityRadius(t)};applyPreset=t=>{const i=ee[t];this.destroy(),this.config={...this.config,...i},this.positionState=N(this.config),l.update(n=>(n.activeComponents.set(this.componentId,this.positionState),n))};destroy=()=>{this.positionState.destroy(),l.update(t=>(t.activeComponents.delete(this.componentId),t.activeComponents.size===0&&P(),t))}}function re(e,t={}){const i=new G(e,{triggerMode:!0,initialVisible:!1,...t}),n=m(i.visible,s=>s),o=m([i.visible,i.showComponent],([s,u])=>u===!0?!0:u===!1?!1:s);return{visible:i.visible,showComponent:i.showComponent,isVisible:n,isDisplay:o,show:i.show,hide:i.hide,toggle:i.toggle,setShowComponent:i.setShowComponent,destroy:i.destroy,manager:i}}function le(e,t={}){const{proximityRadius:i=100,targetArea:n="top",areaOffset:o=50,...s}=t;let u={x:0,y:0};if(typeof window<"u"){const{innerWidth:p,innerHeight:r}=window;switch(n){case"top":u={x:p/2,y:o};break;case"bottom":u={x:p/2,y:r-o};break;case"left":u={x:o,y:r/2};break;case"right":u={x:p-o,y:r/2};break;case"center":u={x:p/2,y:r/2};break}}const a=new G(e,{areaBasedMode:!0,autoStart:!0,proximityRadius:i,componentPosition:u,initialVisible:!1,hideDelay:1e3,...s}),V=m(a.visible,p=>p),x=m([a.visible,a.showComponent],([p,r])=>r===!0?!0:r===!1?!1:p);return a.enableAreaMode(),{visible:a.visible,showComponent:a.showComponent,isDisplay:V,finalVisible:x,show:a.show,hide:a.hide,toggle:a.toggle,setShowComponent:a.setShowComponent,updatePosition:a.updatePositionFromElement,setProximityRadius:a.setProximityRadius,enableAreaMode:a.enableAreaMode,disableAreaMode:a.disableAreaMode,destroy:a.destroy,manager:a}}const h={subscribe:l.subscribe,mousePosition:m(l,e=>e.mousePosition),activeComponents:m(l,e=>Array.from(e.activeComponents.keys())),isMouseTracking:m(l,e=>e.isMouseTracking),globalVisible:m(l,e=>e.globalVisible),showAll:()=>{l.update(e=>(e.activeComponents.forEach(t=>t.show()),e.globalVisible=!0,e))},hideAll:()=>{l.update(e=>(e.activeComponents.forEach(t=>t.hide()),e.globalVisible=!1,e))},toggleAll:()=>{l.update(e=>{const t=!e.globalVisible;return e.activeComponents.forEach(i=>{t?i.show():i.hide()}),e.globalVisible=t,e})},getComponent:e=>{let t;return l.subscribe(i=>{t=i.activeComponents.get(e)})(),t},removeComponent:e=>{l.update(t=>{const i=t.activeComponents.get(e);return i&&(i.destroy(),t.activeComponents.delete(e)),t.activeComponents.size===0&&P(),t})},clearAll:()=>{l.update(e=>(e.activeComponents.forEach(t=>t.destroy()),e.activeComponents.clear(),P(),e))},startMouseTracking:Y,stopMouseTracking:P};function ae(e,t=!1){if(e===void 0)l.update(i=>(i.activeComponents.forEach((n,o)=>{let s=null;n.showComponent.subscribe(u=>{s=u})(),f.set(o,{locked:!0,lockedValue:t,originalValue:s}),n.setShowComponent(t)}),i));else if(Array.isArray(e))e.forEach(i=>{const n=h.getComponent(i);let o=null;n?(n.showComponent.subscribe(s=>{o=s})(),f.set(i,{locked:!0,lockedValue:t,originalValue:o}),n.setShowComponent(t)):f.set(i,{locked:!0,lockedValue:t,originalValue:null})});else{const i=h.getComponent(e);let n=null;i?(i.showComponent.subscribe(o=>{n=o})(),f.set(e,{locked:!0,lockedValue:t,originalValue:n}),i.setShowComponent(t)):f.set(e,{locked:!0,lockedValue:t,originalValue:null})}}function ue(e,t){if(e===void 0)l.update(i=>(i.activeComponents.forEach((n,o)=>{const s=f.get(o),u=t!==void 0?t:s?.originalValue??null;f.set(o,{locked:!1,lockedValue:null,originalValue:null}),n.setShowComponent(u)}),i));else if(Array.isArray(e))e.forEach(i=>{const n=f.get(i),o=t!==void 0?t:n?.originalValue??null;f.set(i,{locked:!1,lockedValue:null,originalValue:null});const s=h.getComponent(i);s&&s.setShowComponent(o)});else{const i=f.get(e),n=t!==void 0?t:i?.originalValue??null;f.set(e,{locked:!1,lockedValue:null,originalValue:null});const o=h.getComponent(e);o&&o.setShowComponent(n)}}function ce(e){const t=h.getComponent(e);if(!t)return console.warn(`Component with ID "${e}" not found.`),null;let i=!1,n=null;t.visible.subscribe(s=>{i=s})(),t.showComponent.subscribe(s=>{n=s})();const o=f.get(e);return{currentState:{visible:i,showComponent:n},lockState:{isLocked:o?.locked??!1,lockedValue:o?.lockedValue??null,originalValue:o?.originalValue??null}}}function fe(e){if(e===void 0){let t=!1;return l.subscribe(i=>{t=i.activeComponents.size>0;for(const[n]of i.activeComponents)if(!w(n))return!1})(),t}else return Array.isArray(e)?e.length===0?!1:e.every(t=>w(t)):w(e)}function pe(e){return X(e)}export{ee as ViewportPositionPresets,G as ViewportVisibilityManager,le as createAreaBasedStateVisibility,re as createStateVisibility,ce as getVisibilityConfig,pe as getVisibilityLockedValue,ne as hideComponent,fe as isVisibilityLocked,ae as lockVisibility,se as resetComponentVisibility,C as setComponentVisibility,oe as showComponent,ue as unlockVisibility,h as viewportVisibilityStore};
